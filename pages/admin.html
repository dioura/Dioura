<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>لوحة الإدارة - Dioura</title>
    <script>
      // immediate guard: redirect to home if not authenticated
      try{
        if (sessionStorage.getItem('dioura_admin_auth') !== '1') {
          // prevent exposing admin UI to unauthenticated visitors
          location.href = '/'
        }
      }catch(e){/* ignore in non-browser contexts */}
    </script>
    <link rel="stylesheet" href="../css/global.css" />
    <link rel="stylesheet" href="../css/header.css" />
    <link rel="stylesheet" href="../css/footer.css" />
    <link rel="stylesheet" href="../css/pages/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
  </head>
  <body>
    <header class="flex">
  <a href="../index.html" class="logo">
        <img src="../images/dioura.png" alt="Dioura" />
        <div class="brand">
          <span>Dioura</span>
          <p>ديورا</p>
        </div>
      </a>

      <div class="links">
        <a style="position: relative" class="cart" href="./cart.html">
          <i class="fa-solid fa-cart-shopping"></i>
          <span class="products-number">0</span>
        </a>
      </div>
    </header>

    <main class="admin-root">
      <h1>لوحة التحكم</h1>

      <section class="panel products-panel">
        <h2>إدارة المنتجات</h2>

        <form id="productForm" class="product-form">
          <input type="hidden" name="index" />
          <label>العنوان<input name="title" required /></label>
          <label>الوصف<textarea name="description" rows="3"></textarea></label>
          <label>المجموعة
            <select name="group" id="productGroup">
              <option value="">اختر المجموعة</option>
            </select>
          </label>
          <label>الفئة الفرعية
            <select name="subcategory" id="productSubcategory">
              <option value="">اختر الفئة</option>
            </select>
          </label>
          <label>الصور (تحميل ملفات متعددة)
            <input name="images" type="file" accept="image/*" multiple />
          </label>
          <div id="imagePreview" class="image-preview" style="margin-top:.5rem"></div>
          <label>السعر (بالل.س)<input name="price" type="number" required /></label>
          <label>خصم (%)<input name="discount" type="number" min="0" max="100" /></label>
          <label><input name="published" type="checkbox" /> منشور</label>
          <div class="form-actions">
            <button type="submit" class="save">حفظ المنتج</button>
            <button type="button" id="clearProductForm">مسح النموذج</button>
          </div>
        </form>

        <div class="products-table-wrap">
          <table id="productsTable">
            <thead>
              <tr>
                <th>معاينة</th>
                <th>العنوان</th>
                <th>المجموعة</th>
                <th>السعر</th>
                <th>الخصم</th>
                <th>المنشور</th>
                <th>إجراءات</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div style="margin-top:.6rem; text-align:left">
            <button id="clearAllProductsBtn" class="btn-small" style="background:#e41d43;color:#fff;padding:.4rem .7rem;border-radius:4px">حذف جميع المنتجات</button>
          </div>
        </div>
      </section>

      <section class="panel orders-panel">
        <h2>الطلبات</h2>
        <div class="orders-table-wrap">
          <table id="ordersTable">
            <thead>
              <tr>
                <th>رقم الطلب</th>
                <th>الزبون</th>
                <th>العناصر</th>
                <th>المجموع</th>
                <th>التاريخ</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <section class="panel coupons-panel">
        <h2>الكوبونات</h2>
        <form id="couponForm" class="coupon-form">
          <label>كود الكوبون<input name="code" required /></label>
          <label>نوع الخصم<select name="type"><option value="percent">%</option><option value="fixed">قيمة ثابتة</option></select></label>
          <label>قيمة الخصم<input name="value" type="number" required /></label>
          <label><input name="active" type="checkbox" checked /> مفعل</label>
          <div class="form-actions"><button type="submit">إضافة/حفظ كوبون</button></div>
        </form>

        <table id="couponsTable">
          <thead><tr><th>الكود</th><th>النوع</th><th>القيمة</th><th>فعال</th><th>إجراءات</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>

      <section class="panel settings-panel">
        <h2>إعدادات الإدارة</h2>
        <form id="adminSettingsForm" class="admin-settings">
          <label>اسم المستخدم الافتراضي<input name="adminUser" placeholder="admin" /></label>
          <label>كلمة المرور الافتراضية<input name="adminPass" type="password" placeholder="admin123" /></label>
          <div class="form-actions">
            <button type="submit" class="save">حفظ بيانات الدخول</button>
            <button type="button" id="adminLogoutBtn" class="btn-small">تسجيل خروج</button>
          </div>
        </form>
      </section>
    </main>

    <footer>
      <div class="footer-bottom">
        <p>© 2025 Dioura — جميع الحقوق محفوظة</p>
      </div>
    </footer>

    <script src="../js/main.js"></script>
    <script src="../js/admin.js"></script>
  </body>
</html>
